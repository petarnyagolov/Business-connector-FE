<div class="forgot-password-container">
  <div class="forgot-password-card">
    <div class="card-header">
      <mat-icon class="header-icon">lock_reset</mat-icon>
      <h1>Забравена парола</h1>
      @if(!emailSent){
      <p class="subtitle">

        Въведете имейл адреса си и ще ви изпратим инструкции за възстановяване на паролата.
      </p>
      }
    </div>

    @if(!emailSent){
    <div class="card-content">
      <form [formGroup]="forgotPasswordForm" (ngSubmit)="onSubmit()">
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Имейл адрес</mat-label>
          <input matInput type="email" formControlName="email" placeholder="name@example.com">
          <mat-icon matPrefix>email</mat-icon>
          @if(forgotPasswordForm.get('email')?.hasError('required')){
          <mat-error>
            Имейлът е задължителен
          </mat-error>
          }
          @if(forgotPasswordForm.get('email')?.hasError('email')){
          <mat-error>
            Невалиден имейл адрес
          </mat-error>
          }
        </mat-form-field>

        <button mat-raised-button color="primary" type="submit" class="submit-button"
          [disabled]="isLoading || forgotPasswordForm.invalid">
          @if (!isLoading) {
          <mat-icon>send</mat-icon>
          }
          @if(isLoading){
          <mat-icon class="spinning">refresh</mat-icon>
          }
          {{ isLoading ? 'Изпращане...' : 'Изпрати инструкции' }}
        </button>

        <div class="back-to-login">
          <button mat-button type="button" (click)="goToLogin()">
            <mat-icon>arrow_back</mat-icon>
            Обратно към вход
          </button>
        </div>
      </form>
    </div>
    }
    @if (emailSent) {
    <div class="success-message">
      <mat-icon class="success-icon">mark_email_read</mat-icon>
      <h2>Имейлът е изпратен!</h2>
      <p>
        Ако имейл адресът съществува в нашата система, вие ще получите инструкции
        за възстановяване на паролата в рамките на няколко минути.
      </p>
      <p class="help-text">
        Не получихте имейл? Проверете папката за спам или
        <a href="#" (click)="emailSent = false; $event.preventDefault()">опитайте отново</a>.
      </p>
      <button mat-raised-button color="primary" (click)="goToLogin()">
        Към вход
      </button>
    </div>
    }
  </div>
</div>