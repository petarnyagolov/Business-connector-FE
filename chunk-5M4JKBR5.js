import{b as z}from"./chunk-3T42K4VL.js";import{b as F}from"./chunk-ZOAOOZOY.js";import{a as Y,b as $}from"./chunk-I2X25UAR.js";import{a as U}from"./chunk-YH2VTUX2.js";import"./chunk-KN5H3PP4.js";import{B as D,C as A}from"./chunk-IFXUHTWD.js";import{$a as P,Bb as a,Cb as p,Cc as k,Db as b,Dc as R,Fa as O,Gc as I,Ja as E,Od as L,Q as M,Wa as d,Xa as u,Za as S,_a as w,ab as e,ba as m,bb as i,ca as _,cb as y,jb as x,k as v,lb as C,nb as s,oc as T,wa as c,zb as N}from"./chunk-BKAIPBB7.js";var Q=(o,n)=>n.id;function j(o,n){if(o&1){let t=x();e(0,"button",9),C("click",function(){m(t);let f=s();return _(f.markAllAsRead())}),e(1,"mat-icon"),a(2,"done_all"),i(),a(3," \u041C\u0430\u0440\u043A\u0438\u0440\u0430\u0439 \u0432\u0441\u0438\u0447\u043A\u0438 \u043A\u0430\u0442\u043E \u043F\u0440\u043E\u0447\u0435\u0442\u0435\u043D\u0438 "),i()}if(o&2){let t=s();P("disabled",t.isLoading)}}function H(o,n){if(o&1&&(e(0,"div",6)(1,"div",10)(2,"div",11),a(3),i(),e(4,"div",12),a(5,"\u041E\u0431\u0449\u043E \u0438\u0437\u0432\u0435\u0441\u0442\u0438\u044F"),i()(),e(6,"div",13)(7,"div",11),a(8),i(),e(9,"div",12),a(10,"\u041D\u0435\u043F\u0440\u043E\u0447\u0435\u0442\u0435\u043D\u0438"),i()()()),o&2){let t=s();c(3),p(t.allNotifications.length),c(5),p(t.unreadCount)}}function B(o,n){o&1&&(e(0,"div",7),y(1,"mat-spinner",14),e(2,"p"),a(3,"\u0417\u0430\u0440\u0435\u0436\u0434\u0430\u043D\u0435 \u043D\u0430 \u0438\u0437\u0432\u0435\u0441\u0442\u0438\u044F..."),i()())}function W(o,n){if(o&1){let t=x();e(0,"button",30),C("click",function(f){m(t);let l=s().$implicit,g=s(2);return _(g.markAsRead(l.id,f))}),e(1,"mat-icon"),a(2,"done"),i()()}}function G(o,n){o&1&&(e(0,"div",26)(1,"mat-icon",31),a(2,"check_circle"),i()())}function Z(o,n){if(o&1&&(e(0,"div",29)(1,"mat-icon"),a(2,"link"),i(),e(3,"span"),a(4),i()()),o&2){let t=s().$implicit;c(4),b("ID: ",t.referenceId)}}function q(o,n){if(o&1){let t=x();e(0,"div",17),C("click",function(){let f=m(t).$implicit,l=s(2);return _(l.onNotificationClick(f))}),e(1,"div",18)(2,"div",19)(3,"mat-icon",20),a(4),i()(),e(5,"div",21)(6,"span",22),a(7),i(),e(8,"span",23),a(9),i()(),e(10,"div",24),d(11,W,3,0,"button",25),d(12,G,3,0,"div",26),i()(),e(13,"div",27)(14,"h3",28),a(15),i(),d(16,Z,5,1,"div",29),i()()}if(o&2){let t=n.$implicit,r=s(2);N("unread",!t.isRead),c(3),P("color",r.getNotificationColor(t.type)),c(),b(" ",r.getNotificationIcon(t.type)," "),c(3),p(r.getNotificationTypeLabel(t.type)),c(2),p(r.formatTime(t.createdAt)),c(2),u(t.isRead?-1:11),c(),u(t.isRead?12:-1),c(3),p(t.title),c(),u(t.referenceId?16:-1)}}function J(o,n){o&1&&(e(0,"div",16)(1,"mat-icon"),a(2,"notifications_none"),i(),e(3,"h2"),a(4,"\u041D\u044F\u043C\u0430 \u0438\u0437\u0432\u0435\u0441\u0442\u0438\u044F"),i(),e(5,"p"),a(6,"\u0412\u0441\u0435 \u043E\u0449\u0435 \u043D\u044F\u043C\u0430 \u043F\u043E\u043B\u0443\u0447\u0435\u043D\u0438 \u0438\u0437\u0432\u0435\u0441\u0442\u0438\u044F."),i(),e(7,"button",32)(8,"mat-icon"),a(9,"explore"),i(),a(10," \u0420\u0430\u0437\u0433\u043B\u0435\u0434\u0430\u0439 \u043F\u0443\u0431\u043B\u0438\u043A\u0430\u0446\u0438\u0438 "),i()())}function K(o,n){if(o&1&&(e(0,"div",8),S(1,q,17,10,"div",15,Q),d(3,J,11,0,"div",16),i()),o&2){let t=s();c(),w(t.allNotifications),c(2),u(t.allNotifications.length===0?3:-1)}}var V=class o{constructor(n,t){this.wsService=n;this.router=t;this.userTimezone=Intl.DateTimeFormat().resolvedOptions().timeZone}allNotifications=[];unreadCount=0;isLoading=!0;userTimezone="";destroy$=new v;ngOnInit(){this.wsService.connect(),this.setupVisibilityChangeListener(),setTimeout(()=>{this.loadAllNotifications()},500),this.wsService.notifications.pipe(M(this.destroy$)).subscribe(n=>{console.log("\u{1F4E8} Real-time notifications update:",n.length),this.allNotifications=n,this.isLoading=!1}),this.wsService.unreadCount.pipe(M(this.destroy$)).subscribe(n=>{console.log("\u{1F4CA} Unread count update:",n),this.unreadCount=n})}setupVisibilityChangeListener(){document.addEventListener("visibilitychange",()=>{document.visibilityState==="visible"&&this.loadAllNotifications()})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}loadAllNotifications(){this.isLoading=!0,setTimeout(()=>{this.isLoading&&this.wsService.isFullNotificationsLoaded()?this.isLoading=!1:this.isLoading&&(this.allNotifications=this.wsService.getCurrentNotifications(),this.unreadCount=this.wsService.getCurrentUnreadCount(),this.isLoading=!1)},3e3)}trackByNotificationId(n,t){return t.id}onNotificationClick(n){n.isRead||this.markAsRead(n.id),n.url&&this.router.navigate([n.url])}markAsRead(n,t){t&&t.stopPropagation(),this.wsService.markAsRead(n)}markAllAsRead(){this.wsService.markAllAsRead()}getNotificationIcon(n){switch(n){case"NEW_REQUEST_IN_INDUSTRY":return"business";case"RESPONSE_TO_MY_REQUEST":return"reply";case"MY_RESPONSE_CHOSEN":return"star";case"REQUEST_STATUS_CHANGED":return"update";case"COMPANY_CREATED_IN_INDUSTRY":return"domain";default:return"notifications"}}getNotificationColor(n){switch(n){case"NEW_REQUEST_IN_INDUSTRY":return"primary";case"RESPONSE_TO_MY_REQUEST":return"accent";case"MY_RESPONSE_CHOSEN":return"warn";case"REQUEST_STATUS_CHANGED":return"primary";case"COMPANY_CREATED_IN_INDUSTRY":return"primary";default:return"primary"}}getNotificationTypeLabel(n){switch(n){case"NEW_REQUEST_IN_INDUSTRY":return"\u041D\u043E\u0432\u0430 \u043F\u0443\u0431\u043B\u0438\u043A\u0430\u0446\u0438\u044F \u0432 \u0441\u0435\u043A\u0442\u043E\u0440\u0430";case"RESPONSE_TO_MY_REQUEST":return"\u041E\u0442\u0433\u043E\u0432\u043E\u0440 \u043D\u0430 \u043F\u0443\u0431\u043B\u0438\u043A\u0430\u0446\u0438\u044F";case"MY_RESPONSE_CHOSEN":return"\u0418\u0437\u0431\u0440\u0430\u043D\u043E \u043F\u0440\u0435\u0434\u043B\u043E\u0436\u0435\u043D\u0438\u0435";case"REQUEST_STATUS_CHANGED":return"\u041F\u0440\u043E\u043C\u044F\u043D\u0430 \u0432 \u0441\u0442\u0430\u0442\u0443\u0441\u0430";case"COMPANY_CREATED_IN_INDUSTRY":return"\u041D\u043E\u0432\u0430 \u043A\u043E\u043C\u043F\u0430\u043D\u0438\u044F \u0432 \u0441\u0435\u043A\u0442\u043E\u0440\u0430";default:return"\u0418\u0437\u0432\u0435\u0441\u0442\u0438\u0435"}}formatTime(n){let t=new Date(n),f=new Date().getTime()-t.getTime(),l=Math.floor(f/6e4),g=Math.floor(l/60),h=Math.floor(g/24);return l<1?"\u0421\u0435\u0433\u0430":l<60?`${l} \u043C\u0438\u043D`:g<24?`${g} \u0447\u0430\u0441${g!==1?"\u0430":""}`:h<30?`${h} \u0434\u0435\u043D${h!==1?"\u0438":""}`:t.toLocaleDateString("bg-BG",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit",timeZoneName:"short"})}getTimezoneInfo(){let n=-new Date().getTimezoneOffset()/60,t=n>=0?"+":"-";return`${this.userTimezone} (UTC${t}${Math.abs(n)})`}static \u0275fac=function(t){return new(t||o)(O(U),O(k))};static \u0275cmp=E({type:o,selectors:[["app-notifications"]],decls:16,vars:5,consts:[[1,"notifications-page"],[1,"notifications-header"],[1,"header-actions"],[1,"timezone-info",2,"font-size","0.85rem","color","#666","margin-right","16px","display","flex","align-items","center","gap","4px"],[2,"font-size","16px","width","16px","height","16px"],["mat-raised-button","","color","primary",3,"disabled"],[1,"notifications-stats"],[1,"loading-container"],[1,"notifications-container"],["mat-raised-button","","color","primary",3,"click","disabled"],[1,"stat-card"],[1,"stat-number"],[1,"stat-label"],[1,"stat-card","unread"],["diameter","50"],[1,"notification-card",3,"unread"],[1,"empty-state"],[1,"notification-card",3,"click"],[1,"notification-header"],[1,"notification-icon"],[3,"color"],[1,"notification-meta"],[1,"notification-type"],[1,"notification-time"],[1,"notification-actions"],["mat-icon-button","","matTooltip","\u041C\u0430\u0440\u043A\u0438\u0440\u0430\u0439 \u043A\u0430\u0442\u043E \u043F\u0440\u043E\u0447\u0435\u0442\u0435\u043D\u043E"],[1,"read-indicator"],[1,"notification-body"],[1,"notification-title"],[1,"notification-reference"],["mat-icon-button","","matTooltip","\u041C\u0430\u0440\u043A\u0438\u0440\u0430\u0439 \u043A\u0430\u0442\u043E \u043F\u0440\u043E\u0447\u0435\u0442\u0435\u043D\u043E",3,"click"],["color","primary"],["mat-raised-button","","color","primary","routerLink","/requests"]],template:function(t,r){t&1&&(e(0,"div",0)(1,"div",1)(2,"h1")(3,"mat-icon"),a(4,"notifications"),i(),a(5," \u0412\u0441\u0438\u0447\u043A\u0438 \u0418\u0437\u0432\u0435\u0441\u0442\u0438\u044F "),i(),e(6,"div",2)(7,"div",3)(8,"mat-icon",4),a(9,"schedule"),i(),e(10,"span"),a(11),i()(),d(12,j,4,1,"button",5),i()(),d(13,H,11,2,"div",6),d(14,B,4,0,"div",7),d(15,K,4,1,"div",8),i()),t&2&&(c(11),p(r.getTimezoneInfo()),c(),u(r.unreadCount>0?12:-1),c(),u(r.isLoading?-1:13),c(),u(r.isLoading?14:-1),c(),u(r.isLoading?-1:15))},dependencies:[T,A,D,L,z,$,Y,F,I,R],styles:['[_nghost-%COMP%]{display:block;min-height:100vh;background:linear-gradient(135deg,#f8faff,#eef5ff)}.notifications-page[_ngcontent-%COMP%]{max-width:1000px;margin:0 auto;padding:24px}@media (max-width: 768px){.notifications-page[_ngcontent-%COMP%]{padding:16px}}.notifications-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:32px}@media (max-width: 768px){.notifications-header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:16px}}.notifications-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;margin:0;font-size:32px;font-weight:700;background:linear-gradient(135deg,#2196f3,#673ab7);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}.notifications-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:36px;width:36px;height:36px;color:#2196f3}@media (max-width: 768px){.notifications-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:28px}.notifications-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:32px;width:32px;height:32px}}@media (max-width: 768px){.notifications-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]{width:100%}}.notifications-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border-radius:24px;font-weight:600;text-transform:none;box-shadow:0 4px 12px #2196f34d;transition:all .3s ease}.notifications-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover:not(:disabled){transform:translateY(-2px);box-shadow:0 6px 16px #2196f366}.notifications-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled{opacity:.6}@media (max-width: 768px){.notifications-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%}}.notifications-stats[_ngcontent-%COMP%]{display:flex;gap:20px;margin-bottom:32px}@media (max-width: 768px){.notifications-stats[_ngcontent-%COMP%]{gap:16px}}.notifications-stats[_ngcontent-%COMP%]   .stat-card[_ngcontent-%COMP%]{flex:1;background:#ffffffe6;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);border:1px solid rgba(255,255,255,.2);border-radius:16px;padding:24px;text-align:center;box-shadow:0 8px 32px #0000001a;transition:all .3s ease}.notifications-stats[_ngcontent-%COMP%]   .stat-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 12px 40px #00000026}.notifications-stats[_ngcontent-%COMP%]   .stat-card.unread[_ngcontent-%COMP%]{background:linear-gradient(135deg,#ff98001a,#ffc1071a);border-color:#ff980033}@media (max-width: 768px){.notifications-stats[_ngcontent-%COMP%]   .stat-card[_ngcontent-%COMP%]{padding:20px}}.notifications-stats[_ngcontent-%COMP%]   .stat-card[_ngcontent-%COMP%]   .stat-number[_ngcontent-%COMP%]{font-size:32px;font-weight:700;color:#2196f3;margin-bottom:8px}.unread[_ngcontent-%COMP%]   .notifications-stats[_ngcontent-%COMP%]   .stat-card[_ngcontent-%COMP%]   .stat-number[_ngcontent-%COMP%]{color:#ff9800}@media (max-width: 768px){.notifications-stats[_ngcontent-%COMP%]   .stat-card[_ngcontent-%COMP%]   .stat-number[_ngcontent-%COMP%]{font-size:28px}}.notifications-stats[_ngcontent-%COMP%]   .stat-card[_ngcontent-%COMP%]   .stat-label[_ngcontent-%COMP%]{font-size:14px;color:#666;font-weight:500;text-transform:uppercase;letter-spacing:.5px}.loading-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:80px 20px;gap:20px}.loading-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:16px;color:#666;margin:0}.notifications-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px}.notification-card[_ngcontent-%COMP%]{background:#fffffff2;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);border:1px solid rgba(255,255,255,.2);border-radius:16px;padding:24px;cursor:pointer;transition:all .3s ease;position:relative;overflow:hidden}.notification-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 12px 40px #00000026;background:#fff}.notification-card.unread[_ngcontent-%COMP%]{background:linear-gradient(135deg,#2196f30d,#673ab70d);border-left:4px solid #2196F3}.notification-card.unread[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:0;width:100%;height:100%;background:linear-gradient(135deg,#2196f305,#673ab705);pointer-events:none}@media (max-width: 768px){.notification-card[_ngcontent-%COMP%]{padding:20px}}.notification-card[_ngcontent-%COMP%]   .notification-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px;margin-bottom:16px}.notification-card[_ngcontent-%COMP%]   .notification-header[_ngcontent-%COMP%]   .notification-icon[_ngcontent-%COMP%]{flex-shrink:0;width:48px;height:48px;border-radius:50%;background:linear-gradient(135deg,#2196f31a,#673ab71a);display:flex;align-items:center;justify-content:center;transition:all .3s ease}.notification-card[_ngcontent-%COMP%]   .notification-header[_ngcontent-%COMP%]   .notification-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:24px;width:24px;height:24px}.notification-card[_ngcontent-%COMP%]   .notification-header[_ngcontent-%COMP%]   .notification-meta[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;gap:4px}.notification-card[_ngcontent-%COMP%]   .notification-header[_ngcontent-%COMP%]   .notification-meta[_ngcontent-%COMP%]   .notification-type[_ngcontent-%COMP%]{font-size:12px;font-weight:600;color:#2196f3;text-transform:uppercase;letter-spacing:.5px}.notification-card[_ngcontent-%COMP%]   .notification-header[_ngcontent-%COMP%]   .notification-meta[_ngcontent-%COMP%]   .notification-time[_ngcontent-%COMP%]{font-size:14px;color:#666}.notification-card[_ngcontent-%COMP%]   .notification-header[_ngcontent-%COMP%]   .notification-actions[_ngcontent-%COMP%]{flex-shrink:0}.notification-card[_ngcontent-%COMP%]   .notification-header[_ngcontent-%COMP%]   .notification-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:50%;background:#2196f31a;transition:all .3s ease}.notification-card[_ngcontent-%COMP%]   .notification-header[_ngcontent-%COMP%]   .notification-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background:#2196f333;transform:scale(1.1)}.notification-card[_ngcontent-%COMP%]   .notification-header[_ngcontent-%COMP%]   .notification-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#2196f3;font-size:20px;width:20px;height:20px}.notification-card[_ngcontent-%COMP%]   .notification-header[_ngcontent-%COMP%]   .notification-actions[_ngcontent-%COMP%]   .read-indicator[_ngcontent-%COMP%]{width:40px;height:40px;display:flex;align-items:center;justify-content:center}.notification-card[_ngcontent-%COMP%]   .notification-header[_ngcontent-%COMP%]   .notification-actions[_ngcontent-%COMP%]   .read-indicator[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:20px;width:20px;height:20px;opacity:.6}.notification-card[_ngcontent-%COMP%]   .notification-body[_ngcontent-%COMP%]   .notification-title[_ngcontent-%COMP%]{margin:0 0 12px;font-size:18px;font-weight:600;color:#333;line-height:1.4}.unread[_ngcontent-%COMP%]   .notification-card[_ngcontent-%COMP%]   .notification-body[_ngcontent-%COMP%]   .notification-title[_ngcontent-%COMP%]{font-weight:700}@media (max-width: 768px){.notification-card[_ngcontent-%COMP%]   .notification-body[_ngcontent-%COMP%]   .notification-title[_ngcontent-%COMP%]{font-size:16px}}.notification-card[_ngcontent-%COMP%]   .notification-body[_ngcontent-%COMP%]   .notification-reference[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;font-size:14px;color:#666;background:#0000000d;padding:8px 12px;border-radius:8px;width:fit-content}.notification-card[_ngcontent-%COMP%]   .notification-body[_ngcontent-%COMP%]   .notification-reference[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:16px;width:16px;height:16px;color:#999}.empty-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:80px 20px;text-align:center}.empty-state[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:80px;width:80px;height:80px;color:#ddd;margin-bottom:24px;opacity:.7}@media (max-width: 768px){.empty-state[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:64px;width:64px;height:64px}}.empty-state[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0 0 16px;font-size:28px;color:#666;font-weight:600}@media (max-width: 768px){.empty-state[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:24px}}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:16px;color:#999;margin:0 0 32px;max-width:400px;line-height:1.6}.empty-state[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border-radius:24px;font-weight:600;text-transform:none;padding:12px 32px;box-shadow:0 4px 12px #2196f34d;transition:all .3s ease}.empty-state[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 6px 16px #2196f366}@keyframes _ngcontent-%COMP%_slideInFromRight{0%{opacity:0;transform:translate(100px)}to{opacity:1;transform:translate(0)}}.notification-card.new-notification[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_slideInFromRight .5s ease-out}@keyframes _ngcontent-%COMP%_pulse{0%,to{opacity:1}50%{opacity:.7}}.notification-card.unread[_ngcontent-%COMP%]   .notification-icon[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_pulse 2s infinite}']})};export{V as NotificationsComponent};
